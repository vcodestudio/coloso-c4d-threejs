import{S as I,i as N,s as V,k as X,l as Y,m as T,h as D,n as U,b as j,I as b,o as B,w as O}from"../chunks/index.2ecc7cbf.js";import{f as x,E as Q,aB as $,W as J,P as Z,S as ee,C as ne,A as te,F as oe,G as ie,M as se,D as re,H as ae}from"../chunks/three.module.ef5c776a.js";import{G as ce}from"../chunks/GLTFLoader.b6027147.js";const p=new $(0,0,0,"YXZ"),v=new x,de={type:"change"},le={type:"lock"},me={type:"unlock"},F=Math.PI/2;class ue extends Q{constructor(n,r){super(),this.domElement=r,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1;const e=this;function o(t){if(e.isLocked===!1)return;const c=t.movementX||t.mozMovementX||t.webkitMovementX||0,w=t.movementY||t.mozMovementY||t.webkitMovementY||0;p.setFromQuaternion(n.quaternion),p.y-=c*.002*e.pointerSpeed,p.x-=w*.002*e.pointerSpeed,p.x=Math.max(F-e.maxPolarAngle,Math.min(F-e.minPolarAngle,p.x)),n.quaternion.setFromEuler(p),e.dispatchEvent(de)}function i(){e.domElement.ownerDocument.pointerLockElement===e.domElement?(e.dispatchEvent(le),e.isLocked=!0):(e.dispatchEvent(me),e.isLocked=!1)}function a(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){e.domElement.ownerDocument.addEventListener("mousemove",o),e.domElement.ownerDocument.addEventListener("pointerlockchange",i),e.domElement.ownerDocument.addEventListener("pointerlockerror",a)},this.disconnect=function(){e.domElement.ownerDocument.removeEventListener("mousemove",o),e.domElement.ownerDocument.removeEventListener("pointerlockchange",i),e.domElement.ownerDocument.removeEventListener("pointerlockerror",a)},this.dispose=function(){this.disconnect()},this.getObject=function(){return n},this.getDirection=function(){const t=new x(0,0,-1);return function(c){return c.copy(t).applyQuaternion(n.quaternion)}}(),this.moveForward=function(t){v.setFromMatrixColumn(n.matrix,0),v.crossVectors(n.up,v),n.position.addScaledVector(v,t)},this.moveRight=function(t){v.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(v,t)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){e.domElement.ownerDocument.exitPointerLock()},this.connect()}}function we(k){let n;return{c(){n=X("canvas"),this.h()},l(r){n=Y(r,"CANVAS",{class:!0}),T(n).forEach(D),this.h()},h(){U(n,"class","svelte-1rxwyaw")},m(r,e){j(r,n,e),k[1](n)},p:b,i:b,o:b,d(r){r&&D(n),k[1](null)}}}let C=3500,S=8964607;function he(k,n,r){let e,o,i,a,t,c,w=!1,E=!1,y=!1,L=!1,_=!1,g=new x,d=new x,P=performance.now(),u=0;B(()=>{K(),A()});function K(){a=new J({antialias:!0,canvas:e}),a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),o=new Z(45,window.innerWidth/window.innerHeight,30,2e3),o.position.set(0,0,0),i=new ee,i.background=new ne(S),a.toneMapping=te,i.fog=new oe(S,500,2e3);const s=new ie;s.position.copy(o.position),s.rotation.copy(o.rotation),i.add(s),s.add(o),window.addEventListener("resize",W),new ce().load("/move/model.glb",function(z){c=z.scene,c.position.set(0,0,0);const h=.1;c.scale.set(h,h,h),i.add(c);const f=z.cameras[0];o.position.set(f.position.x*h,f.position.y*h,f.position.z*h),o.rotation.set(f.rotation.x,f.rotation.y,f.rotation.z),t=new ue(o,document.body),t.addEventListener("lock",function(){document.body.style.cursor="none"}),t.addEventListener("unlock",function(){document.body.style.cursor="auto"}),window.addEventListener("click",function(){t.lock()}),i.add(t.getObject());const q=function(m){switch(m.code){case"ArrowUp":case"KeyW":w=!0;break;case"ArrowLeft":case"KeyA":y=!0;break;case"ArrowDown":case"KeyS":E=!0;break;case"ArrowRight":case"KeyD":L=!0;break;case"Space":_===!0&&(d.y+=350),_=!1;break}},G=function(m){switch(m.code){case"ArrowUp":case"KeyW":w=!1;break;case"ArrowLeft":case"KeyA":y=!1;break;case"ArrowDown":case"KeyS":E=!1;break;case"ArrowRight":case"KeyD":L=!1;break}};document.addEventListener("keydown",q),document.addEventListener("keyup",G),c.traverse(function(m){m.isMesh&&(m.material=new se({color:16777215,roughness:.3}),m.castShadow=!0,m.receiveShadow=!0)})});const l=new re(16777215,1);l.position.set(1,1,1),l.castShadow=!0,l.shadow.mapSize.width=2048,l.shadow.mapSize.height=2048,l.shadow.camera.near=.5,l.shadow.camera.far=500,l.shadow.radius=1,i.add(l);const M=new ae(S,14540253,.35);M.position.set(0,-1,0),i.add(M)}function A(){const s=performance.now();requestAnimationFrame(A),u=(s-P)/1e3,g.z=Number(w)-Number(E),g.x=Number(L)-Number(y),g.normalize(),(w||E)&&(d.z-=g.z*C*u),(y||L)&&(d.x-=g.x*C*u),t.moveRight(-d.x*u),t.moveForward(-d.z*u),d.x-=d.x*5*u,d.z-=d.z*5*u,P=s,R()}function R(){a.render(i,o)}function W(){o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)}function H(s){O[s?"unshift":"push"](()=>{e=s,r(0,e)})}return[e,H]}class ge extends I{constructor(n){super(),N(this,n,he,we,V,{})}}export{ge as default};
