import{S as V,i as X,s as Y,y as Z,a as J,k as K,z as Q,c as ee,l as ne,m as te,h as j,n as $,A as oe,b as R,I as ae,g as ie,d as se,B as re,o as ce,w as le}from"../chunks/index.2ecc7cbf.js";import{C as u,P as me,S as de,F as ue,W as fe,s as pe,n as we,H as ge,a as be,L as A,g as he,M as _e,b as ve,R as ye,V as W,c as Me}from"../chunks/three.module.2b01c56e.js";import{O as ke}from"../chunks/OrbitControls.938ce638.js";import{G as Pe}from"../chunks/GLTFLoader.6b96b0db.js";import{E as Ce,R as xe,U as je}from"../chunks/UnrealBloomPass.6138d20b.js";import{C as Ae}from"../chunks/cursor.d83b6330.js";function Le(M){let c,w,o,n;return c=new Ae({}),{c(){Z(c.$$.fragment),w=J(),o=K("canvas"),this.h()},l(e){Q(c.$$.fragment,e),w=ee(e),o=ne(e,"CANVAS",{id:!0,class:!0}),te(o).forEach(j),this.h()},h(){$(o,"id","canvas"),$(o,"class","svelte-1p4771a")},m(e,t){oe(c,e,t),R(e,w,t),R(e,o,t),M[1](o),n=!0},p:ae,i(e){n||(ie(c.$$.fragment,e),n=!0)},o(e){se(c.$$.fragment,e),n=!1},d(e){re(c,e),e&&j(w),e&&j(o),M[1](null)}}}function Be(M,c,w){let o,n,e,t,a,g,L,C,v;const z=new Me;let k="background_1";const F=[new u("hsl(240, 100%, 50%)"),new u("hsl(10, 100%, 50%)"),new u("hsl(190, 100%, 50%)"),new u("hsl(200, 100%, 100%)")];ce(()=>{S(),B()});function S(){n=new me(35,window.innerWidth/window.innerHeight,1,2e3),n.position.set(0,0,100),e=new de;const f=new u("hsl(200, 100%, 20%)");e.background=new u(f),e.fog=new ue(f,850,1200),t=new fe({antialias:!0,canvas:o}),t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight),t.outputEncoding=pe,t.toneMapping=we,t.toneMappingExposure=3,window.addEventListener("resize",I);const O=new ge(16777215,0,1);O.position.set(0,500,0),e.add(O),H();const T=new Pe,q=document.querySelector("input.baseUrl").value;T.load(`${q}scene/scene-1-bake-2.glb`,function(m){const r=m.scene;console.log("root",m);const b=.1;r.scale.set(b,b,b);const h=m.cameras[0];if(n.position.set(h.position.x*b,h.position.y*b,h.position.z*b),n.rotation.set(h.rotation.x,h.rotation.y,h.rotation.z),a=new ke(n,t.domElement),a.target.set(0,90,0),a.enablePan=!1,a.enableZoom=!1,a.minPolarAngle=Math.PI/2,a.maxPolarAngle=Math.PI/2,a.minAzimuthAngle=-.5*Math.PI/2,a.maxAzimuthAngle=.5*Math.PI/2,a.dampingFactor=.05,a.enableDamping=!0,a.update(),g=new be(r),m.animations,L=g.clipAction(m.animations[0]),L.loop=A,r.traverse(function(i){i.isMesh&&(i.material=new he({color:i.material.color??16777215,map:i.material.map,userData:{color:i.material.color}}),i.name.toLowerCase()=="button")}),r.getObjectByName("realtime").traverse(function(i){i.isMesh&&(i.material=new _e({color:i.material.color??16777215,map:i.material.map}))}),e.add(r),r.getObjectByName("background_1").visible=!1,r.getObjectByName("background_2").visible=!1,r.getObjectByName(k).visible=!0,m.animations.length>0){let D=function(d){x.x=d.clientX/window.innerWidth*2-1,x.y=-(d.clientY/window.innerHeight)*2+1},U=function(d){E.setFromCamera(x,n);const p=E.intersectObjects(e.children,!0);if(p.length>0&&p[0].object.name.toLowerCase().includes("button")){const _=P.find(s=>s.name==p[0].object.name.toLowerCase());if(_){const s=g.clipAction(_);s.loop=A,s.reset(),s.play()}const y=p[0].object.name.toLowerCase().replace("button_","");if(y.includes("color")){const s=r.getObjectByName("change"),l=y.split("color_")[1];s.material.color=F[l-1]}else if(y.includes("right")||y.includes("left")){const s=r.getObjectByName("background_1"),l=r.getObjectByName("background_2"),N=r.getObjectByName("panel_background");s.visible=!1,l.visible=!1,k=="background_1"?(l.visible=!0,k="background_2",N.material.color=new u("blue")):(s.visible=!0,k="background_1",N.material.color=new u("#66FF00"))}else if(y.includes("publish")){const s=P.find(l=>l.name=="rocket");if(s){const l=g.clipAction(s);l.loop=A,l.clampWhenFinished=!0,l.play(),setTimeout(()=>{document.body.className="end"},1500),setTimeout(()=>{location.href=location.href},3e3)}}}};const i=m.animations[0].tracks,P=[];i.forEach(d=>{const p=P.find(_=>_.name==d.name.split(".")[0]);if(p)p.tracks.push(d);else{const _=new ve(d.name.split(".")[0],-1,[d]);P.push(_)}});const E=new ye,x=new W;window.addEventListener("mousemove",D,!1),window.addEventListener("click",U,!1)}},void 0,function(m){console.error(m)})}function H(){C=new Ce(t),C.addPass(new xe(e,n)),v=new je(new W(window.innerWidth,window.innerHeight),1.5,.4,.85),v.threshold=.75,v.strength=1.5,v.radius=1,C.addPass(v)}function I(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight)}function B(){requestAnimationFrame(B),t.render(e,n),a&&a.update();const f=z.getDelta();g&&g.update(f)}function G(f){le[f?"unshift":"push"](()=>{o=f,w(0,o)})}return[o,G]}class Fe extends V{constructor(c){super(),X(this,c,Be,Le,Y,{})}}export{Fe as default};
