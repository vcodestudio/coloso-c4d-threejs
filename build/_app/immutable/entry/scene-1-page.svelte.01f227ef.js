import{S as J,i as N,s as Z,y as K,a as Q,k as ee,z as te,c as ne,l as ae,m as oe,h as L,n as se,A as ie,b as E,J as re,g as le,d as ce,B as me,o as pe,w as de}from"../chunks/index.32e2af34.js";import{P as fe,S as ue,C as z,F as we,W as he,s as ge,as as be,X as Me,B as F,z as Pe,T as k,a1 as _e,at as xe,R as ye,V as B,a as Ae,L as H,g as Ce,y as I,c as ve}from"../chunks/three.module.a6fd982f.js";import{O as Le}from"../chunks/OrbitControls.4dddf048.js";import{G as ze}from"../chunks/GLTFLoader.a254f7ff.js";import{E as Se,R as Re,U as We}from"../chunks/UnrealBloomPass.f7db90c7.js";import{C as $e}from"../chunks/cursor.f16d2033.js";function Ee(d){let s,f,r,a;return s=new $e({}),{c(){K(s.$$.fragment),f=Q(),r=ee("canvas"),this.h()},l(e){te(s.$$.fragment,e),f=ne(e),r=ae(e,"CANVAS",{id:!0}),oe(r).forEach(L),this.h()},h(){se(r,"id","canvas")},m(e,o){ie(s,e,o),E(e,f,o),E(e,r,o),d[1](r),a=!0},p:re,i(e){a||(le(s.$$.fragment,e),a=!0)},o(e){ce(s.$$.fragment,e),a=!1},d(e){me(s,e),e&&L(f),e&&L(r),d[1](null)}}}function S(d){let s=Math.sin(d)*1e4;return s-Math.floor(s)}function Fe(d,s,f){let r,a,e,o,i,b,u,_,g;const x=[],T=new ve;let y;pe(()=>{G(),R()});function G(){a=new fe(35,window.innerWidth/window.innerHeight,1,2e3),a.position.set(0,0,100),e=new ue;const p=new z("hsl(255, 70%, 40%)");e.background=new z(p),e.fog=new we(p,850,1200),o=new he({antialias:!0,canvas:r}),o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),o.outputEncoding=ge,o.toneMapping=be,o.toneMappingExposure=3,window.addEventListener("resize",O);let w=300,A=new Me,M=new Float32Array(w*3),P=new Float32Array(w*3),W=650,C=650;for(let t=0;t<w;t++){let c=Math.sin(t/w*Math.PI*2)*W+(S(t*3)-.5)*C,l=(S(t*3+1)-.5)*C*.5,m=Math.cos(t/w*Math.PI*2)*W+(S(t*3+2)-.5)*C;M[t*3]=c,M[t*3+1]=l,M[t*3+2]=m;let n=new z(16777215);P[t*3]=n.r,P[t*3+1]=n.g,P[t*3+2]=n.b}A.setAttribute("position",new F(M,3)),A.setAttribute("color",new F(P,3));let q=new Pe({size:10,vertexColors:!0,map:new k().load("/misc/sphere.png"),transparent:!0,alphaTest:.5});y=new _e(A,q),y.position.set(0,60,0),e.add(y);const V=new xe(16777215,1);e.add(V),j();const $=new ye,v=new B;function D(t){v.x=t.clientX/window.innerWidth*2-1,v.y=-(t.clientY/window.innerHeight)*2+1,$.setFromCamera(v,a);const c=$.intersectObjects(x);if(c.length>0){const l=c[0].object;l.name==="button"&&l.isMesh&&(u.loop=H,u.clampWhenFinished=!0,u.reset(),u.play())}}window.addEventListener("click",D,!1);const X=new ze,Y=document.querySelector("input.baseUrl").value;X.load(`${Y}scene/scene-0-bake-2.glb`,function(t){const c=t.scene;console.log("root",t);const l=.1;c.scale.set(l,l,l);const m=t.cameras[0];a.position.set(m.position.x*l,m.position.y*l,m.position.z*l),a.rotation.set(m.rotation.x,m.rotation.y,m.rotation.z),i=new Le(a,o.domElement),i.target.set(0,90,0),i.enablePan=!1,i.enableZoom=!1,i.minPolarAngle=Math.PI/2,i.maxPolarAngle=Math.PI/2,i.minAzimuthAngle=-.5*Math.PI/2,i.maxAzimuthAngle=.5*Math.PI/2,i.dampingFactor=.05,i.enableDamping=!0,i.update(),b=new Ae(c),t.animations,u=b.clipAction(t.animations[0]),u.loop=H,c.traverse(function(n){n.isMesh&&(n.material=new Ce({color:n.material.color??16777215,map:n.material.map}),n.castShadow=!0,n.receiveShadow=!0,n.name.toLowerCase()=="button"&&x.push(n),n.name.toLowerCase()=="ground"&&new k().load("/misc/circle.exr",function(h){console.log("text",h),h.flipY=!1,h.wrapS=I,h.wrapT=I,h.repeat.set(1,1),n.material.map=h,n.material.transparent=!0,n.material.needsUpdate=!0}))}),console.log(c),e.add(c)},void 0,function(t){console.error(t)})}function j(){_=new Se(o),_.addPass(new Re(e,a)),g=new We(new B(window.innerWidth,window.innerHeight),1.5,.4,.85),g.threshold=.75,g.strength=1.5,g.radius=1,_.addPass(g)}function O(){a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function R(){requestAnimationFrame(R),o.render(e,a),i&&i.update();const p=T.getDelta();b&&b.update(p),x.forEach(w=>{})}function U(p){de[p?"unshift":"push"](()=>{r=p,f(0,r)})}return[r,U]}class Oe extends J{constructor(s){super(),N(this,s,Fe,Ee,Z,{})}}export{Oe as default};
