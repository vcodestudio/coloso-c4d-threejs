import{S as X,i as Z,s as J,y as K,a as Q,k as ee,z as te,c as ne,l as ae,m as oe,h as L,n as se,A as ie,b as E,I as re,g as le,d as ce,B as me,o as pe,w as de}from"../chunks/index.2ecc7cbf.js";import{P as fe,S as ue,C as S,F as we,W as he,s as ge,n as be,B as Me,j as k,k as Pe,T as F,m as _e,o as xe,R as Ae,V as B,a as ye,L as I,g as Ce,p as H,c as ve}from"../chunks/three.module.2b01c56e.js";import{O as Le}from"../chunks/OrbitControls.938ce638.js";import{G as Se}from"../chunks/GLTFLoader.6b96b0db.js";import{E as ze,R as Re,U as We}from"../chunks/UnrealBloomPass.6138d20b.js";import{C as $e}from"../chunks/cursor.d83b6330.js";function Ee(d){let s,f,r,a;return s=new $e({}),{c(){K(s.$$.fragment),f=Q(),r=ee("canvas"),this.h()},l(e){te(s.$$.fragment,e),f=ne(e),r=ae(e,"CANVAS",{id:!0}),oe(r).forEach(L),this.h()},h(){se(r,"id","canvas")},m(e,o){ie(s,e,o),E(e,f,o),E(e,r,o),d[1](r),a=!0},p:re,i(e){a||(le(s.$$.fragment,e),a=!0)},o(e){ce(s.$$.fragment,e),a=!1},d(e){me(s,e),e&&L(f),e&&L(r),d[1](null)}}}function z(d){let s=Math.sin(d)*1e4;return s-Math.floor(s)}function ke(d,s,f){let r,a,e,o,i,b,u,_,g;const x=[],T=new ve;let A;pe(()=>{j(),R()});function j(){a=new fe(35,window.innerWidth/window.innerHeight,1,2e3),a.position.set(0,0,100),e=new ue;const p=new S("hsl(255, 70%, 40%)");e.background=new S(p),e.fog=new we(p,850,1200),o=new he({antialias:!0,canvas:r}),o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),o.outputEncoding=ge,o.toneMapping=be,o.toneMappingExposure=3,window.addEventListener("resize",O);let w=300,y=new Me,M=new Float32Array(w*3),P=new Float32Array(w*3),W=650,C=650;for(let t=0;t<w;t++){let c=Math.sin(t/w*Math.PI*2)*W+(z(t*3)-.5)*C,l=(z(t*3+1)-.5)*C*.5,m=Math.cos(t/w*Math.PI*2)*W+(z(t*3+2)-.5)*C;M[t*3]=c,M[t*3+1]=l,M[t*3+2]=m;let n=new S(16777215);P[t*3]=n.r,P[t*3+1]=n.g,P[t*3+2]=n.b}y.setAttribute("position",new k(M,3)),y.setAttribute("color",new k(P,3));let q=new Pe({size:10,vertexColors:!0,map:new F().load("/misc/sphere.png"),transparent:!0,alphaTest:.5});A=new _e(y,q),A.position.set(0,60,0),e.add(A);const V=new xe(16777215,1);e.add(V),G();const $=new Ae,v=new B;function D(t){v.x=t.clientX/window.innerWidth*2-1,v.y=-(t.clientY/window.innerHeight)*2+1,$.setFromCamera(v,a);const c=$.intersectObjects(x);if(c.length>0){const l=c[0].object;l.name==="button"&&l.isMesh&&(u.loop=I,u.clampWhenFinished=!0,u.reset(),u.play())}}window.addEventListener("click",D,!1);const Y=new Se,N=document.querySelector("input.baseUrl").value;Y.load(`${N}scene/scene-0-bake-2.glb`,function(t){const c=t.scene;console.log("root",t);const l=.1;c.scale.set(l,l,l);const m=t.cameras[0];a.position.set(m.position.x*l,m.position.y*l,m.position.z*l),a.rotation.set(m.rotation.x,m.rotation.y,m.rotation.z),i=new Le(a,o.domElement),i.target.set(0,90,0),i.enablePan=!1,i.enableZoom=!1,i.minPolarAngle=Math.PI/2,i.maxPolarAngle=Math.PI/2,i.minAzimuthAngle=-.5*Math.PI/2,i.maxAzimuthAngle=.5*Math.PI/2,i.dampingFactor=.05,i.enableDamping=!0,i.update(),b=new ye(c),t.animations,u=b.clipAction(t.animations[0]),u.loop=I,c.traverse(function(n){n.isMesh&&(n.material=new Ce({color:n.material.color??16777215,map:n.material.map}),n.castShadow=!0,n.receiveShadow=!0,n.name.toLowerCase()=="button"&&x.push(n),n.name.toLowerCase()=="ground"&&new F().load("/misc/circle.exr",function(h){console.log("text",h),h.flipY=!1,h.wrapS=H,h.wrapT=H,h.repeat.set(1,1),n.material.map=h,n.material.transparent=!0,n.material.needsUpdate=!0}))}),console.log(c),e.add(c)},void 0,function(t){console.error(t)})}function G(){_=new ze(o),_.addPass(new Re(e,a)),g=new We(new B(window.innerWidth,window.innerHeight),1.5,.4,.85),g.threshold=.75,g.strength=1.5,g.radius=1,_.addPass(g)}function O(){a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function R(){requestAnimationFrame(R),o.render(e,a),i&&i.update();const p=T.getDelta();b&&b.update(p),x.forEach(w=>{})}function U(p){de[p?"unshift":"push"](()=>{r=p,f(0,r)})}return[r,U]}class Oe extends X{constructor(s){super(),Z(this,s,ke,Ee,J,{})}}export{Oe as default};
